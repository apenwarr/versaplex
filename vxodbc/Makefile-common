default: all

OBJS=\
	bind.o \
	columninfo.o \
	connection.o \
	convert.o \
	dlg_specific.o \
	dlg_wingui.o \
	drvconn.o \
	environ.o \
	execute.o \
	info.o \
	info30.o \
	misc.o \
	mylog.o \
	pgapi30.o \
	multibyte.o \
	options.o \
	parse.o \
	pgtypes.o \
	psqlodbc.o \
	qresult.o \
	results.o \
	statement.o \
	tuple.o \
	odbcapi.o \
	odbcapi30.o \
	descriptor.o \
	odbcapiw.o \
	odbcapi30w.o \
	inouealc.o \
	win_unicode.o \
	wvlogger.o

# Files made by configure
CONFIGUREFILES=\
	configure \
	config.status \
	config.h \
	config.h.in

distclean: clean
	rm -f $(CONFIGUREFILES)
	rm -rf autom4te.cache

$(OBJS): configure config.h 

clean:
	rm -f *.o *.so *~ *.res *.dll *.a .*.d *.d 
	$(MAKE) -C t $@

%.E: %.c
	$(CC) -o $@ -E $< $(CFLAGS)
	
%.E: %.cc
	$(CC) -o $@ -E $< $(CXXFLAGS)
	
%.o: %.c
	@echo Compiling $@...
	@$(CC) -o $@ -c -MMD -MP -MF .$*.d $< $(CFLAGS)

%.o: %.cc
	@echo Compiling $@...
	@$(CXX) -o $@ -c -MMD -MP -MF .$*.d $< $(CXXFLAGS)

config.h.in: configure.ac aclocal.m4
	autoheader

configure: configure.ac config.h.in
	autoconf

include $(wildcard .*.d)

test: vxodbc.so vxodbc-test.so
	$(MAKE) -C t $@
